/**********************************************\
*  FancyPants — customElements micro-lib   O   *
*  MIT — Copyright © 2020 Devin Weaver    /|\  *
*  https://fancy-pants.js.org/            </>  *
\**********************************************/
const ATTACH_EVENT=Symbol("attach event");const NULL_SELECTOR=Symbol("null selector");const DATA=Symbol("private data");class Eventer{constructor({scope:e,selector:t,eventType:r,listener:n}){assertQueryable(e,t);this[DATA]={scope:e,selector:t,eventType:r,listener:n}}[ATTACH_EVENT](){let{scope:e,selector:t,eventType:r,listener:n=(()=>{})}=this[DATA];let l=e=>{if(this.willPreventDefault){e.preventDefault()}if(this.willStopPropagation){e.stopPropagation()}return n(e)};let o=queryAll(e,t);o.forEach((e=>e.addEventListener(r,l)));return()=>o.forEach((e=>e.removeEventListener(r,l)))}preventDefault(){this.willPreventDefault=true}stopPropagation(){this.willStopPropagation=true}}function queryAll(e,t){return t===NULL_SELECTOR?[e]:e.querySelectorAll(t)}function assertQueryable(e,t){if(!e?.querySelectorAll){throw new ReferenceError(`${e} does not implement the querySelectorAll interface`)}if(!t){throw new Error("selector must be defined before registering any tasks")}}function dslBuilder(e,t){let r=document;let n;let l=t=>e.push(i(t));let o=e=>(...t)=>{e(...t);return s};let s=o(((e,t=r)=>{r=t;n=e??NULL_SELECTOR}));let u=new Proxy({},{get(e,t){if(t==="on"){return(t,r)=>{e.eventer=a(t,r);return u}}else if(!Reflect.has(e,"eventer")){return r=>{e.eventer=a(t,r);return u}}else if(Reflect.has(e.eventer,t)){return(...r)=>{e.eventer[t](...r);return u}}else{delete e.eventer;return s[t]}}});function a(e,l){let o=new Eventer({scope:r,selector:n,eventType:e,listener:l});t.push(o);return o}function i(e){let t=r;let l=n;assertQueryable(t,l);return()=>queryAll(t,l).forEach(e)}return Object.assign(s,{event:u,scope:o((e=>{r=e;n=NULL_SELECTOR})),select:o((e=>n=e??NULL_SELECTOR)),run:o(l),text:o((e=>l((t=>t.textContent=e(t))))),html:o((e=>l((t=>t.innerHTML=e(t))))),clear:o(((e=(()=>true))=>l((t=>e(t)&&(t.innerHTML=""))))),prop:o(((e,t)=>l((r=>r[e]=t(r))))),data:o(((e,t)=>l((r=>r.dataset[e]=t(r))))),attr:o(((e,t)=>l((r=>{let n=t(r);if(n===true){r.setAttribute(e,"")}else if(n===false||n==null){r.removeAttribute(e)}else{r.setAttribute(e,`${n}`)}})))),value:e=>s.prop("value",e),check:e=>s.prop("checked",e),show:e=>s.attr("hidden",e),hide:e=>s.attr("hidden",(t=>!e(t)))})}function domFactory(e,t){let r=[];let n=[];e(dslBuilder(r,n));r=r.map(t);return[()=>r.forEach((e=>e())),()=>{let e=n.map((e=>e[ATTACH_EVENT]()));return()=>e.forEach((e=>e()))}]}function dom(e){return domFactory(e,(e=>e))}dom.factory=function e(t){return e=>domFactory(e,t)};export default dom;
